<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ“œ Ancient Calling â€” ë‹¤ì¤‘ì§€ëŠ¥ íƒí—˜</title>
<link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Cinzel:wght@700&display=swap" rel="stylesheet">
<style>
:root { --brown-text:#4a3a2a; --gold:#c89a4b; }
*{box-sizing:border-box}
body{margin:0;font-family:'Gowun Dodum',serif;background:#5d4037 url('https://images.unsplash.com/photo-1520256862855-398228c41684?q=80&w=2070&auto=format&fit=crop') center/cover no-repeat fixed;color:#fff;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px;position:relative;overflow:hidden}
body:before{content:'';position:absolute;inset:0;background:rgba(0,0,0,.45)}
.wrap{position:relative;z-index:1;width:100%;max-width:1200px}
.header{text-align:center;margin-bottom:16px}
.title{font-family:'Cinzel',serif;font-size:clamp(2rem,5vw,3.25rem);color:var(--gold);text-shadow:2px 2px 8px rgba(0,0,0,.8)}
.subtitle{opacity:.9;font-size:clamp(1rem,2vw,1.1rem)}
.layout{display:flex;gap:16px}
.left{width:360px}
.right{flex:1}
.card{background:rgba(0,0,0,.6);backdrop-filter:blur(8px);border-radius:16px;padding:16px;border:1px solid rgba(255,215,102,.15);box-shadow:0 10px 30px rgba(0,0,0,.5)}
.char-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.char{padding:10px;border-radius:12px;background:rgba(0,0,0,.35);text-align:center;cursor:pointer;border:1px solid transparent;transition:.2s}
.char:hover{transform:translateY(-3px);border-color:var(--gold)}
.char.selected{background:rgba(200,154,75,.28);border-color:var(--gold);transform:translateY(-3px)}
label{display:block;color:var(--gold);font-weight:700;margin:6px 0}
input[type=text]{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,215,102,.2);background:rgba(0,0,0,.3);color:#fff;margin-bottom:8px}
.btn{display:inline-flex;gap:8px;align-items:center;justify-content:center;padding:12px 16px;border-radius:12px;border:none;cursor:pointer;background:linear-gradient(145deg,#b38645,#835e2c);color:#fff;font-weight:700;width:100%;font-size:1rem;box-shadow:0 5px 15px rgba(0,0,0,.4);transition:.2s}
.btn:hover{transform:translateY(-1px)}
.btn:disabled{background:#555;cursor:not-allowed;box-shadow:none}
#game-card{background:url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=2070&auto=format&fit=crop') center/cover no-repeat;color:var(--brown-text);padding:40px;min-height:560px;position:relative}
.quest-header{text-align:center;margin-bottom:8px}
.quest-header h3{font-family:'Cinzel',serif;color:#5b3e22;margin:0;font-size:clamp(1.1rem,2.2vw,1.4rem)}
.quest-text{font-size:clamp(1rem,2.1vw,1.2rem);line-height:1.9;min-height:116px}
.options{display:grid;grid-template-columns:1fr;gap:10px;margin-top:14px}
.option{padding:12px;border-radius:12px;background:rgba(189,168,133,.35);cursor:pointer;border:1px solid rgba(112,83,48,.3);transition:.15s;text-align:center;user-select:none}
.option:hover{transform:scale(1.02);background:rgba(189,168,133,.5)}
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px;color:#fff}
.stat{background:rgba(0,0,0,.35);padding:8px;border-radius:10px;text-align:center}
.bar{height:10px;background:rgba(255,255,255,.12);border-radius:6px;margin-top:8px;overflow:hidden}
.bar-inner{height:100%;background:linear-gradient(90deg,var(--gold),#e6b873);width:0%}
.result-content{text-align:center}
@media(max-width:900px){.layout{flex-direction:column}.left{width:100%}#game-card{padding:28px}}
.spinner{display:none;border:4px solid rgba(255,255,255,.3);border-top:4px solid var(--gold);border-radius:50%;width:26px;height:26px;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.small{font-size:.9rem;opacity:.9}
</style>
</head>
<body>
<audio id="bgm" src="https://assets.mixkit.co/sfx/preview/mixkit-calm-music-2200.mp3" loop></audio>
<audio id="sfx-turn" src="https://assets.mixkit.co/sfx/preview/mixkit-game-click-1110.mp3"></audio>
<audio id="sfx-magic" src="https://www.soundjay.com/misc/sounds/magic-chime-02.mp3"></audio>

<div class="wrap">
  <div class="header">
    <div class="title">Ancient Calling</div>
    <div class="subtitle">ì¤‘1 ëª¨í—˜ê°€ë¥¼ ìœ„í•œ ë‹¤ì¤‘ì§€ëŠ¥ íƒí—˜ RPG</div>
  </div>

  <div class="layout">
    <div class="left">
      <div class="card">
        <label>ëª¨í—˜ê°€ ì´ë¦„</label>
        <input id="input-name" type="text" placeholder="ì˜ˆ: ê¹€ë¯¼ì¤€" />
        <label>ì†Œì† (ë°˜)</label>
        <input id="input-class" type="text" placeholder="ì˜ˆ: 1í•™ë…„ 3ë°˜" />
        <label>ì—¬ì •ì„ í•¨ê»˜í•  ë™ë£Œ</label>
        <div id="char-row" class="char-row">
          <div class="char" data-id="warrior"><div class="emoji">âš”ï¸</div><div class="name">ì „ì‚¬</div></div>
          <div class="char" data-id="wizard"><div class="emoji">ğŸ”®</div><div class="name">ë§ˆë²•ì‚¬</div></div>
          <div class="char" data-id="archer"><div class="emoji">ğŸ¹</div><div class="name">ê¶ìˆ˜</div></div>
          <div class="char" data-id="healer"><div class="emoji">ğŸŒ¿</div><div class="name">ì¹˜ìœ ì‚¬</div></div>
        </div>
        <div style="margin-top:16px">
          <button id="btn-start" class="btn" disabled>
            <span id="start-btn-text">â–¶ ëª¨í—˜ ì‹œì‘í•˜ê¸°</span>
            <div id="start-btn-spinner" class="spinner"></div>
          </button>
          <p class="small" style="margin:10px 0 0">ì„ íƒì§€ëŠ” ì¬ë¯¸ìˆê²Œ ë³´ì´ì§€ë§Œ, ê°ê° <strong>8ê°€ì§€ ì§€ëŠ¥</strong> ì¤‘ í•˜ë‚˜ì™€ ì—°ê²°ë©ë‹ˆë‹¤.</p>
        </div>
      </div>

      <div id="stats-panel" class="card" style="margin-top:12px; display:none;">
          <div id="stats" class="stats-grid"></div>
      </div>
    </div>

    <div class="right">
      <div id="game-card" class="card">
        <div id="pre-game" style="text-align:center; padding-top:60px">
          <h3 style="font-family:'Cinzel', serif; color:#5b3e22">ğŸ“œ ëª¨í—˜ì˜ ì„œë§‰</h3>
          <p class="small" style="color:#2e1f13;background:rgba(255,255,255,.6);display:inline-block;padding:10px 12px;border-radius:10px">ì´ë¦„/ë°˜ì„ ì ê³  ìºë¦­í„°ë¥¼ ê³ ë¥¸ ë’¤ ì‹œì‘í•˜ì„¸ìš”. <br/>ê° ì„ íƒì€ ë‹¹ì‹ ì˜ ê°•ì ì„ ë¹„ì¶”ëŠ” íŒíŠ¸ê°€ ë©ë‹ˆë‹¤.</p>
        </div>

        <div id="game-area" style="display:none">
          <div class="quest-header"><h3 id="quest-title"></h3></div>
          <div id="quest-text" class="quest-text"></div>
          <div id="options" class="options"></div>
        </div>
        
        <div id="result-area" style="display:none; padding-top: 40px;">
          <div class="result-content" id="result-content"></div>
          <button id="btn-restart" class="btn" style="max-width:300px; margin: 18px auto 0;">ğŸ”„ ìƒˆë¡œìš´ ëª¨í—˜ ì‹œì‘í•˜ê¸°</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ===== ì‚¬ìš´ë“œ =====
const S = { bgm: document.getElementById('bgm'), click: document.getElementById('sfx-turn'), magic: document.getElementById('sfx-magic') };
S.bgm.volume = 0.18;

// ===== ê³µìš© í—¬í¼ =====
const el = id => document.getElementById(id);
const baseScores = {linguistic:50,logical:50,spatial:50,bodily:50,musical:50,interpersonal:50,intrapersonal:50,naturalist:50};
let scores = {};
let player = {name:'',clazz:'',charId:'',questIndex:0};

const NAMES = {linguistic:'ì–¸ì–´ ì§€ëŠ¥',logical:'ë…¼ë¦¬-ìˆ˜í•™ ì§€ëŠ¥',spatial:'ê³µê°„ ì§€ëŠ¥',bodily:'ì‹ ì²´-ìš´ë™ ì§€ëŠ¥',musical:'ìŒì•… ì§€ëŠ¥',interpersonal:'ëŒ€ì¸ê´€ê³„ ì§€ëŠ¥',intrapersonal:'ìê¸°ì´í•´ ì§€ëŠ¥',naturalist:'ìì—°ì¹œí™” ì§€ëŠ¥'};

// ===== ì„œì‚¬: ì±•í„° íƒ€ì´í‹€ & ì¥ë©´ í…ìŠ¤íŠ¸(20ë‹¨ê³„) =====
const CHAPTERS = {
  warrior: [
    ['ìˆ²ì˜ ê²½ê³„','ì•ˆê°œ ë‚€ ìˆ² ê°€ì¥ìë¦¬ì—ì„œ ëª¨í—˜ì˜ ì²« ë°œì„ ë‚´ë”›ëŠ”ë‹¤.'],
    ['ë¶ˆì”¨ì™€ ë°”ëŒ','ë§ˆì„ í™”í†³ë¶ˆì´ êº¼ì§€ê³  ë‘ë ¤ì›€ì´ ê°ëˆë‹¤.'],
    ['ì´ˆì›ì˜ ì™¸ì¹¨','ë“¤íŒ ëì—ì„œ ë„ì›€ì„ ì²­í•˜ëŠ” ëª©ì†Œë¦¬ê°€ ë“¤ë¦°ë‹¤.'],
    ['ë¬´ë„ˆì§„ ë‹¤ë¦¬','ê³¨ì§œê¸°ì˜ ë‚˜ë¬´ë‹¤ë¦¬ê°€ í”ë“¤ë¦°ë‹¤.'],
    ['ëŒì˜ ê¸°ì–µ','ê³ ëŒ€ ì„ìƒì´ í¬ë¯¸í•œ ë¹›ì„ ë‚¸ë‹¤.'],
    ['ìš©ì˜ ìˆ¨ê²°','ë™êµ´ ê¹Šìˆ™ì´ ë”°ëœ»í•œ ë°”ëŒì´ ë¶„ë‹¤.'],
    ['ì„±ë²½ì˜ ê·¸ë¦¼ì','ì„±ë¬¸ ì• ê¸´ í–‰ë ¬, ë¶ˆì•ˆì´ ìŠ¤ë¯¼ë‹¤.'],
    ['ì „ìš°ì˜ ë§¹ì„¸','ë™ë£Œë“¤ì˜ ëˆˆë¹›ì´ í”ë“¤ë¦°ë‹¤.'],
    ['ëª¨ë˜ì˜ ì‹œê³„','í™©ë¬´ì§€ì—ì„œ ì‚¬ë§‰ í­í’ì´ ë‹¤ê°€ì˜¨ë‹¤.'],
    ['ë°¤ì˜ ì¶”ì ','ë‹¬ë¹› ì•„ë˜ ìˆ˜ìƒí•œ í”ì ì´ ì´ì–´ì§„ë‹¤.'],
    ['ê°€ë©´ì˜ ì‹œì¥','ë¶„ì£¼í•œ ì‹œì¥ì— ê±°ì§“ ì†Œë¬¸ì´ ëˆë‹¤.'],
    ['ê°•ì² ì˜ ì‹œí—˜','í›ˆë ¨ì¥ì— ì˜¤ë˜ëœ ì‹œí—˜ì´ ì—´ë ¸ë‹¤.'],
    ['ìˆ²ì˜ ì‹¬ì¥','ê±°ëŒ€í•œ ë‚˜ë¬´ë¿Œë¦¬ ì†ì— ê¸¸ì´ ìˆ¨ëŠ”ë‹¤.'],
    ['ë©”ì•„ë¦¬ì˜ í˜‘ê³¡','í•¨ì„±ë„ ì†ì‚­ì„ë„ í¬ê²Œ ìš¸ë¦¬ëŠ” ì ˆë²½.'],
    ['ë¹›ì˜ ê³„ë‹¨','êµ¬ë¦„ê³„ë¥¼ ì˜¤ë¥´ë©´ ì„±ì†Œê°€ ë³´ì¸ë‹¤.'],
    ['ê³ ìš”í•œ ì „ì•¼','ê²°ì „ì„ ì•ë‘” ë°¤, ë°”ëŒì´ ì¦ì•„ë“ ë‹¤.'],
    ['ê²©ëŒ','ë§ˆì¹¨ë‚´ ì–´ë‘ ì˜ ì¥êµ°ì´ ë‚˜íƒ€ë‚œë‹¤.'],
    ['í”ë“¤ë¦¼ ì—†ëŠ” ë°œê±¸ìŒ','ì‹¸ì›€ì´ ëë‚˜ê³ ë„ ì‘ì€ ì„ íƒì´ ë‚¨ëŠ”ë‹¤.'],
    ['ì™•ì˜ ì¸ì¥','ì§„ì‹¤ì„ ì¦ëª…í•  í‘œì‹ì„ ì°¾ì•„ì•¼ í•œë‹¤.'],
    ['ìƒˆë²½ì˜ ë¬¸','ìƒˆë²½ë¹›ì´ ì„±ë¬¸ì„ ì ì‹ ë‹¤. ê¸´ ì—¬ì •ì˜ ë.']
  ],
  wizard: [
    ['ë¨¼ì§€ì˜ ì„œê°€','ê³ ìš”í•œ ë„ì„œê´€ì— ë´‰ì¸ëœ ì±…ì´ ë–¨ë¦°ë‹¤.'],
    ['ë£¬ì˜ ë°˜ì§ì„','ë°”ë‹¥ ë¬¸ì–‘ì´ ë¯¸ì„¸í•œ ê·œì¹™ìœ¼ë¡œ íë¥¸ë‹¤.'],
    ['ë³„ì˜ ì‰í¬','ì²œì¥ì— ë³„ë¹› ê¸€ìê°€ ë‚˜íƒ€ë‚œë‹¤.'],
    ['ìˆ˜ì •ì˜ ê· ì—´','ë§ˆë ¥ ìˆ˜ì •ì— ê°€ëŠ” ê¸ˆì´ ê°„ë‹¤.'],
    ['í™˜ì˜ì˜ ë¬¸','ê°™ì€ ë³µë„ê°€ ëì—†ì´ ë°˜ë³µëœë‹¤.'],
    ['ì§€ì‹ì˜ íƒ‘','ë‚˜ì„ ê³„ë‹¨ ìœ„ì—ì„œ ì†ì‚­ì„ì´ ë“¤ë¦°ë‹¤.'],
    ['ê±°ìš¸ì˜ ì§ˆë¬¸','ê±°ìš¸ ì† ë‚´ê°€ ë‹¤ë¥¸ ì£¼ë¬¸ì„ ì™¸ìš´ë‹¤.'],
    ['ì‹œê°„ì˜ ë§¤ë“­','ì‹œê³„ì¶”ê°€ ì•ë’¤ë¡œ ë™ì‹œì— í”ë“¤ë¦°ë‹¤.'],
    ['ê¹ƒí„¸ì˜ ê¸°ë¡','ë„ì„œê´€ ìƒˆê°€ í•œ ê¸€ìë¥¼ ë–¨ì–´ëœ¨ë¦°ë‹¤.'],
    ['ì£¼ë¬¸ ê³µë°©','ì‹¤íŒ¨ì™€ ì„±ê³µì´ êµì°¨í•œë‹¤.'],
    ['í‘ì„œì˜ ìœ í˜¹','ê²€ì€ ì¥ì •ì´ ì€ë¹›ì„ ì‚¼í‚¨ë‹¤.'],
    ['ì›ì†Œì˜ í•©ì£¼','ë¶ˆÂ·ë¬¼Â·ë°”ëŒÂ·í™ì´ í•œ í˜¸í¡ìœ¼ë¡œ ì¶¤ì¶˜ë‹¤.'],
    ['ì •ë ¹ì˜ ìˆ˜ì—…','ë³´ì´ì§€ ì•ŠëŠ” í•™ìƒë“¤ì´ ì•‰ì•„ ìˆë‹¤.'],
    ['ì¹¨ë¬µì˜ ì¢…','ì¢…ì„ ì¹˜ì§€ ì•Šì•„ë„ ìš¸ë¦°ë‹¤.'],
    ['ë´‰ì¸ì˜ ì—´ì‡ ','ì—´ì‡ ëŠ” ë³´ì´ì§€ë§Œ ìë¬¼ì‡ ê°€ ì—†ë‹¤.'],
    ['ë§ˆë ¥ì˜ íë¦„','ì†ëì´ ì €ë¦¿í•˜ë©° ë¹›ì´ ëª¨ì¸ë‹¤.'],
    ['ê³µëª…ì˜ ë°©','í•œ ìƒê°ì´ ì²œ ìƒê°ìœ¼ë¡œ ë²ˆì§„ë‹¤.'],
    ['ì–´ë‘ ì˜ ê· í˜•','ì—†ì• ì§€ ë§ê³  ë‹¤ìŠ¤ë¦¬ë¼ ì†ì‚­ì„ì´ ì˜¨ë‹¤.'],
    ['ì§„ì‹¤ì˜ ë¬¸ì¥','ë§ˆì§€ë§‰ ë¬¸ì¥ í•˜ë‚˜ê°€ ë¹ ì ¸ ìˆë‹¤.'],
    ['ìƒˆë²½ì˜ ìˆ˜ë£Œ','ì²« í˜ì´ì§€ê°€ ë§ˆì§€ë§‰ì„ ì¶•ë³µí•œë‹¤.']
  ],
  archer: [
    ['ë°”ëŒì˜ ê¸¸','ê°ˆëŒ€ìˆ²ì´ ë°”ëŒì˜ ë°©í–¥ì„ ê°€ë¦¬í‚¨ë‹¤.'],
    ['ë§¤ì˜ ëˆˆ','ë¨¼ ìˆ² ì† ë°˜ì§ì„ í•˜ë‚˜.'],
    ['í”ë“¤ë¦¬ëŠ” ë°§ì¤„êµ','ë°œì•„ë˜ ê°•ë¬¼ì´ ì†ì‚­ì¸ë‹¤.'],
    ['ê°œìš¸ì˜ ë¦¬ë“¬','ëŒ ìœ„ë¡œ ë§‘ì€ ë¬¼ì´ ë°•ìë¥¼ ë§Œë“ ë‹¤.'],
    ['ì´ë¼ì˜ ì§€ë¬¸','ë°”ìœ„ë©´ì— ì´ˆë¡ì´ ê¸¸ì„ ìƒˆê¸´ë‹¤.'],
    ['ë°”ìœ„ì˜ í‹ˆ','í˜‘ê³¡ ë°”ëŒì´ í˜¸ë£¨ë¼ê¸°ë¥¼ ë¶„ë‹¤.'],
    ['ê³ ìš”í•œ ìˆ¨','ìˆ¨ì„ ë“¤ì´ì‰¬ì ì„¸ìƒì´ ë˜ë ·í•´ì§„ë‹¤.'],
    ['ì‚¬ìŠ´ì˜ ë°œìêµ­','í•œ ê±¸ìŒ, ë˜ í•œ ê±¸ìŒ.'],
    ['í•˜ëŠ˜ì˜ í‘œì ','êµ¬ë¦„ ì‚¬ì´ í•´ê°€ ì›ì„ ê·¸ë¦°ë‹¤.'],
    ['ë°”ëŒì˜ ì–¸ë•','í’€ìì´ ë¬¼ê²°ì²˜ëŸ¼ ê¸°ìš¸ì–´ì§„ë‹¤.'],
    ['ìƒˆë²½ ì‚¬ëƒ¥','ì²«ë¹›ì´ ìˆ²ì„ ê¹¨ìš´ë‹¤.'],
    ['ë¹„ë°€ ë™êµ´','ë²½í™”ê°€ ë°œê±¸ìŒì„ ë§ì¶˜ë‹¤.'],
    ['ë‚˜ë­‡ê²°ì˜ í¸ì§€','ì—°ë¥œì´ ë‘¥ê¸€ê²Œ ìˆ«ìë¥¼ ë§í•œë‹¤.'],
    ['ë°”ëŒì˜ ì‹œí—˜','ê¹ƒí„¸ í•˜ë‚˜ê°€ í”ë“¤ë¦¼ì„ ê°€ë¥´ì¹œë‹¤.'],
    ['ê°•ê°€ì˜ ë°˜ì‚¬','í‘œì ì€ ë¬¼ ìœ„ì— ìˆë‹¤.'],
    ['ìƒˆì˜ ë…¸ë˜','ë†’ë‚®ì´ê°€ ê¸¸ì„ ë§Œë“ ë‹¤.'],
    ['ì´ˆì ','ëª¨ë“  ì†Œë¦¬ë¥¼ ë‚´ë ¤ë†“ëŠ”ë‹¤.'],
    ['ì—°ëŒ€ì˜ ì‹ í˜¸','ë©€ë¦¬ ë™ë£Œì˜ ì—°ê¸°ê°€ ì†ŸëŠ”ë‹¤.'],
    ['ìì—°ì˜ ë‹µì¥','ìˆ²ì´ ë¨¼ì € ì¸ì‚¬í•œë‹¤.'],
    ['ê·€í™˜','í™œì¤„ì´ ë§ˆìŒì„ ë‹®ì•˜ë‹¤.']
  ],
  healer: [
    ['ë‚™ì—½ì˜ ì†ì‚­ì„','ë§ˆì„ ì•„ì´ì˜ ê¸°ì¹¨ì´ ë°¤ì„ ê¹¨ìš´ë‹¤.'],
    ['ìƒ˜ì˜ ë…¸ë˜','ë¬¼ê²°ì´ ì”ì”íˆ ë§ì„ ê±´ë„¨ë‹¤.'],
    ['ì•½ì´ˆì˜ ê¸¸','í–¥ì´ ì´ë„ëŠ” ì‚°ë¹„íƒˆ.'],
    ['ì†ì˜ ê¸°ì–µ','ë”°ëœ»í•œ ì†ê¸¸ì´ ë–¨ë¦¼ì„ ì¦íŒë‹¤.'],
    ['ì •ë ¹ì˜ ë¶€íƒ','ë³´ì´ì§€ ì•ŠëŠ” ì†ì´ ì–´ê¹¨ì— ë‹¿ëŠ”ë‹¤.'],
    ['í•©ì°½ì˜ ì¹˜ìœ ','ë…¸ë«ê²°ì´ ê³¨ëª©ì„ ê°ì‹¼ë‹¤.'],
    ['ë§ˆì„ íšŒì˜','ì„œë¡œì˜ ë§ì´ ì—‡ê°ˆë¦°ë‹¤.'],
    ['ê³ ìš”ì˜ ë°©','ìˆ¨ì†Œë¦¬ í•˜ë‚˜, ë§¥ í•˜ë‚˜.'],
    ['ë³„ë¹› ê¸°ë¡','ë°¤í•˜ëŠ˜ ì•„ë˜ ë…¸íŠ¸ë¥¼ í¸ë‹¤.'],
    ['ìƒˆì‹¹ì˜ ì¦ì–¸','ì‘ì€ ì´ˆë¡ì´ í° ë³€í™”ë¥¼ ë§í•œë‹¤.'],
    ['ì˜¨ê¸°ì˜ ë¹„ìœ¨','ë¶ˆê½ƒê³¼ ë¬¼ì˜ ê· í˜•ì„ ì¡ëŠ”ë‹¤.'],
    ['ê¸¸ ìœ„ì˜ ìœ„ë¡œ','ë‚¯ì„  ì´ì˜ ëˆˆë¬¼ì´ ë°˜ì§ì¸ë‹¤.'],
    ['ê°•ì˜ ë‹¤ë¦¬','ë„˜ì‹¤ê±°ë¦¼ì— ë¦¬ë“¬ì´ ìˆë‹¤.'],
    ['ê³µê°ì˜ ì›','ì†ì¡ê³  ì›ì„ ë§Œë“ ë‹¤.'],
    ['ë§ˆì§€ë§‰ ì¬ë£Œ','í•œ ê°€ì§€ê°€ ì•„ì§ ëª¨ìë¼ë‹¤.'],
    ['ì„ íƒì˜ ìˆœê°„','ëˆ„êµ¬ë¥¼ ë¨¼ì € ë„ìš¸ê¹Œ.'],
    ['ì´ë³„ê³¼ ê°ì‚¬','êµ¿ë°”ì´, ê·¸ë¦¬ê³  ê³ ë§ˆì›€.'],
    ['íšŒë³µì˜ ì¥','ì›ƒìŒì†Œë¦¬ê°€ ëŒì•„ì˜¨ë‹¤.'],
    ['ê¸°ë¡ì˜ ë§ˆì¹¨í‘œ','ë‹¤ìŒ ëˆ„êµ°ê°€ë¥¼ ìœ„í•´ ë‚¨ê¸´ë‹¤.'],
    ['ìƒˆë²½ì˜ ì¸ì‚¬','ì˜¤ëŠ˜ì˜ ë¹›ìœ¼ë¡œ ë‚´ì¼ì„ ì—°ë‹¤.']
  ]
};

// ===== ì„ íƒì§€ ë¬¸êµ¬ í…œí”Œë¦¿(ìºë¦­í„°ë³„ Ã— 8ì§€ëŠ¥) =====
const TPL = {
  warrior: {
    linguistic: 'ğŸ“œ ì „ì¥ì˜ ê¸°ë¡ê³¼ í‘œì§€ë¥¼ ì½ì–´ ë‹¨ì„œë¥¼ ì°¾ëŠ”ë‹¤. (ì–¸ì–´)',
    logical:   'ğŸ§® ìƒí™©ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„ì„í•´ ìµœì„ ì˜ í•´ë²•ì„ ì„¸ìš´ë‹¤. (ë…¼ë¦¬)',
    spatial:   'ğŸ—ºï¸ ì§€í˜•ì„ ë¨¸ë¦¿ì†ì— ê·¸ë ¤ ë™ì„ ì„ ìµœì í™”í•œë‹¤. (ê³µê°„)',
    bodily:    'âš”ï¸ ëª¸ìœ¼ë¡œ ë¨¼ì € ì›€ì§ì—¬ ê¸¸ì„ ì—°ë‹¤. (ì‹ ì²´)',
    musical:   'ğŸ¥ ë°•ìì™€ ë¦¬ë“¬ìœ¼ë¡œ íŒ€ì˜ í˜¸í¡ì„ ë§ì¶˜ë‹¤. (ìŒì•…)',
    interpersonal:'ğŸ¤ ë™ë£Œì™€ ì†Œí†µí•´ í˜‘ë ¥ì˜ í˜ì„ ëŒì–´ë‚¸ë‹¤. (ëŒ€ì¸)',
    intrapersonal:'ğŸ§˜ ë§ˆìŒì„ ë‹¤ìŠ¤ë ¤ ì¹¨ì°©í•˜ê²Œ ê²°ë‹¨í•œë‹¤. (ìê¸°ì´í•´)',
    naturalist:'ğŸŒ¿ ë°”ëŒÂ·í™Â·ë°œìêµ­ì—ì„œ ìì—°ì˜ íŒíŠ¸ë¥¼ ì½ëŠ”ë‹¤. (ìì—°)'
  },
  wizard: {
    linguistic: 'ğŸ“– ê³ ëŒ€ ë¬¸ì¥ì„ í•´ë…í•´ ì˜ë¯¸ë¥¼ ë°í˜€ë‚¸ë‹¤. (ì–¸ì–´)',
    logical:   'ğŸ§© ë£¬ì˜ ê·œì¹™ì„ ë¶„ì„í•´ ê³µì‹ì„ ì™„ì„±í•œë‹¤. (ë…¼ë¦¬)',
    spatial:   'ğŸ”· ë§ˆë²•ì§„ì˜ êµ¬ì¡°ë¥¼ ì‹œê°í™”í•œë‹¤. (ê³µê°„)',
    bodily:    'ğŸª„ ì†ì§“ê³¼ ì œìŠ¤ì²˜ë¡œ ì •êµí•œ ìºìŠ¤íŒ…ì„ ìˆ˜í–‰í•œë‹¤. (ì‹ ì²´)',
    musical:   'ğŸ¼ ì£¼ë¬¸ì˜ ìŒê³„ë¥¼ ë§ì¶° ê³µëª…ì„ ì¼ìœ¼í‚¨ë‹¤. (ìŒì•…)',
    interpersonal:'ğŸ—£ï¸ ì •ë ¹/ê¸¸ë“œì™€ ëŒ€í™”ë¡œ í˜‘ì—…ì„ ëŒì–´ë‚¸ë‹¤. (ëŒ€ì¸)',
    intrapersonal:'ğŸ§˜â€â™‚ï¸ ë‚´ë©´ì˜ ë§ˆë‚˜ íë¦„ì„ ì¡°ìœ¨í•œë‹¤. (ìê¸°ì´í•´)',
    naturalist:'ğŸƒ ì›ì†Œì™€ ìƒíƒœì˜ ìƒí˜¸ì‘ìš©ì„ ì´ìš©í•œë‹¤. (ìì—°)'
  },
  archer: {
    linguistic: 'ğŸ“ í‘œì‹ê³¼ í”ì ì˜ ì˜ë¯¸ë¥¼ ê¸°ë¡í•œë‹¤. (ì–¸ì–´)',
    logical:   'ğŸ“ ë°”ëŒÂ·ê°ë„Â·ê±°ë¦¬ ê°’ì„ ê³„ì‚°í•œë‹¤. (ë…¼ë¦¬)',
    spatial:   'ğŸ¯ ì›ê±°ë¦¬ ì‹œì•¼ë¡œ ì§€í˜•ì„ ì…ì²´ì ìœ¼ë¡œ íŒŒì•…í•œë‹¤. (ê³µê°„)',
    bodily:    'ğŸƒâ€â™€ï¸ ë¯¼ì²©í•˜ê²Œ ì´ë™í•˜ë©° ìì„¸ë¥¼ ì¡ëŠ”ë‹¤. (ì‹ ì²´)',
    musical:   'ğŸµ ë°”ëŒì†Œë¦¬ì˜ ë°•ìë¡œ íƒ€ì´ë°ì„ ë§ì¶˜ë‹¤. (ìŒì•…)',
    interpersonal:'ğŸ‘¥ ë™ë£Œì™€ ìˆ˜ì‹ í˜¸ë¡œ í˜‘ë™í•œë‹¤. (ëŒ€ì¸)',
    intrapersonal:'ğŸ§˜ í˜¸í¡ì„ ë‚®ì¶”ê³  ì§‘ì¤‘ì„ ê·¹ëŒ€í™”í•œë‹¤. (ìê¸°ì´í•´)',
    naturalist:'ğŸ¦Œ ë™ì‹ë¬¼ì˜ ìŠµì„±ì„ ì½ì–´ ê¸¸ì„ ì°¾ëŠ”ë‹¤. (ìì—°)'
  },
  healer: {
    linguistic: 'âœï¸ ì¦ìƒê³¼ ë³€í™”ë¥¼ ì„¸ë°€íˆ ê¸°ë¡í•´ ì†Œí†µí•œë‹¤. (ì–¸ì–´)',
    logical:   'âš–ï¸ ì›ì¸-ê²°ê³¼ë¥¼ ì •ë¦¬í•´ ì²˜ë°©ì„ ì„¤ê³„í•œë‹¤. (ë…¼ë¦¬)',
    spatial:   'ğŸ§­ ì´ë™ ë™ì„ ì„ ì„¤ê³„í•˜ê³  ë°°ì¹˜í•œë‹¤. (ê³µê°„)',
    bodily:    'ğŸ¤² ì†ê¸°ìˆ ê³¼ ë„êµ¬ë¡œ ì§ì ‘ ëŒë³¸ë‹¤. (ì‹ ì²´)',
    musical:   'ğŸ¶ ì•ˆì •ì˜ ë©œë¡œë””ë¡œ ë§ˆìŒì„ ê°€ë¼ì•‰íŒë‹¤. (ìŒì•…)',
    interpersonal:'ğŸ’¬ ê³µê°ê³¼ ìƒë‹´ìœ¼ë¡œ ì‹ ë¢°ë¥¼ ì„¸ìš´ë‹¤. (ëŒ€ì¸)',
    intrapersonal:'ğŸ«€ ìŠ¤ìŠ¤ë¡œì˜ ê°ì •ì„ ì‚´í”¼ë©° ê· í˜•ì„ ì¡ëŠ”ë‹¤. (ìê¸°ì´í•´)',
    naturalist:'ğŸŒ± ì•½ì´ˆÂ·ë¬¼Â·í–‡ë¹› ë“± ìì—° ì¹˜ìœ ë ¥ì„ í™œìš©í•œë‹¤. (ìì—°)'
  }
};

// ===== ê° ë‹¨ê³„ì—ì„œ ì œì‹œí•  4ì§€ëŠ¥(20ë‹¨ê³„ Ã— ìºë¦­í„° ê³µí†µ ë¡œí…Œì´ì…˜) =====
// 20ë‹¨ê³„ ë™ì•ˆ 8ì§€ëŠ¥ì´ ê³ ë¥´ê²Œ ì—¬ëŸ¬ ë²ˆ ë‚˜íƒ€ë‚˜ë„ë¡ ì„¤ê³„
const ROTATION = [
  ['linguistic','logical','interpersonal','bodily'],
  ['spatial','naturalist','intrapersonal','musical'],
  ['logical','spatial','bodily','interpersonal'],
  ['naturalist','linguistic','musical','intrapersonal'],
  ['bodily','spatial','logical','naturalist'],
  ['musical','interpersonal','linguistic','intrapersonal'],
  ['spatial','logical','musical','bodily'],
  ['interpersonal','intrapersonal','linguistic','naturalist'],
  ['logical','naturalist','spatial','interpersonal'],
  ['linguistic','musical','bodily','intrapersonal'],
  ['naturalist','spatial','interpersonal','logical'],
  ['musical','linguistic','intrapersonal','bodily'],
  ['spatial','naturalist','logical','linguistic'],
  ['interpersonal','musical','bodily','spatial'],
  ['intrapersonal','linguistic','naturalist','logical'],
  ['bodily','interpersonal','spatial','musical'],
  ['logical','intrapersonal','linguistic','naturalist'],
  ['spatial','bodily','musical','interpersonal'],
  ['naturalist','logical','intrapersonal','linguistic'],
  ['musical','spatial','interpersonal','bodily']
];

// ===== í€˜ìŠ¤íŠ¸ ë°ì´í„° ìƒì„±: 4ìºë¦­í„° Ã— 20ë‹¨ê³„ =====
function buildQuests(charId){
  const list = CHAPTERS[charId];
  return list.map((pair, idx)=>{
    const [title, scene] = pair;
    const keys = ROTATION[idx];
    const options = keys.map(k=>({ t: TPL[charId][k], e: {[k]: 12} }));
    return { title, text: scene, options };
  });
}

const quests = {
  warrior: buildQuests('warrior'),
  wizard:  buildQuests('wizard'),
  archer:  buildQuests('archer'),
  healer:  buildQuests('healer')
};

// ===== ì¸í„°ë™ì…˜ =====
function resetGame(){
  scores = JSON.parse(JSON.stringify(baseScores));
  player = {name:'',clazz:'',charId:'',questIndex:0};
  document.querySelectorAll('.char').forEach(c=>c.classList.remove('selected'));
  el('game-area').style.display='none';
  el('result-area').style.display='none';
  el('pre-game').style.display='block';
  el('stats-panel').style.display='none';
  el('input-name').value='';
  el('input-class').value='';
  el('start-btn-text').style.display='inline';
  el('start-btn-spinner').style.display='none';
  checkStartButton();
}

function checkStartButton(){
  const name = el('input-name').value.trim();
  const clazz = el('input-class').value.trim();
  const isChar = !!player.charId;
  el('btn-start').disabled = !(name && clazz && isChar);
}

document.querySelectorAll('.char').forEach(node=>{
  node.addEventListener('click',()=>{
    document.querySelectorAll('.char').forEach(c=>c.classList.remove('selected'));
    node.classList.add('selected');
    player.charId = node.dataset.id;
    checkStartButton();
  });
});

el('input-name').addEventListener('input',checkStartButton);
el('input-class').addEventListener('input',checkStartButton);

el('btn-start').addEventListener('click',()=>{
  const name = el('input-name').value.trim();
  const clazz = el('input-class').value.trim();
  if(!(name&&clazz&&player.charId)) return;
  player.name=name; player.clazz=clazz; player.questIndex=0;
  el('start-btn-text').style.display='none';
  el('start-btn-spinner').style.display='block';
  S.bgm.play().catch(()=>{});
  setTimeout(()=>{
    el('pre-game').style.display='none';
    el('game-area').style.display='block';
    el('stats-panel').style.display='block';
    renderQuest();
    el('start-btn-text').style.display='inline';
    el('start-btn-spinner').style.display='none';
  },800);
});

el('btn-restart').addEventListener('click',resetGame);

function renderQuest(){
  const list = quests[player.charId];
  if(!list || player.questIndex >= list.length){
    return showResult();
  }
  const q = list[player.questIndex];
  el('quest-title').textContent = `ğŸ“œ Chapter ${player.questIndex+1}: ${q.title}`;
  el('quest-text').textContent = q.text;
  const root = el('options');
  root.innerHTML = '';
  q.options.forEach((o)=>{
    const div = document.createElement('div');
    div.className='option';
    div.textContent = o.t;
    div.onclick = ()=>{
      S.click.currentTime=0; S.click.play();
      applyEffects(o.e);
      player.questIndex++;
      renderStats();
      setTimeout(()=>{ S.magic.currentTime=0; S.magic.play(); renderQuest(); }, 220);
    };
    root.appendChild(div);
  });
  renderStats();
}

function applyEffects(e){ Object.keys(e).forEach(k=>{ if(scores[k]!==undefined) scores[k]+=e[k]; }); }

function renderStats(){
  const root = el('stats');
  root.innerHTML='';
  Object.keys(scores).forEach(k=>{
    const score = Math.min(100, Math.max(0, scores[k]));
    const box = document.createElement('div');
    box.className='stat';
    box.innerHTML = `<div style="font-weight:700;color:var(--gold)">${NAMES[k]}</div>`+
      `<div class="bar"><div class="bar-inner" style="width:${score}%"></div></div>`;
    root.appendChild(box);
  });
}

function showResult(){
  el('game-area').style.display='none';
  el('stats-panel').style.display='none';
  el('result-area').style.display='block';
  const entries = Object.entries(scores).sort((a,b)=>b[1]-a[1]);
  const [top1, top2, top3] = [entries[0][0], entries[1][0], entries[2][0]];
  const resultHTML = `
    <h3 style="font-family:'Cinzel',serif;color:#5b3e22">ğŸ“œ ëª¨í—˜ì˜ ê²°ê³¼</h3>
    <p><strong>${player.name}</strong>(${player.clazz}) ëª¨í—˜ê°€ë‹˜, í›Œë¥­í•˜ê²Œ 20ë‹¨ê³„ ì—¬ì •ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤.</p>
    <p>ë‹¹ì‹ ì˜ ì„ íƒì„ ì¢…í•©í•´ ë³¸ ê²°ê³¼â€¦</p>
    <h4 style="color:var(--gold);margin:.4em 0">ğŸ¥‡ ë‹¹ì‹ ì˜ ê°•ì  ì§€ëŠ¥ì€ <strong>${NAMES[top1]}</strong> ì…ë‹ˆë‹¤!</h4>
    <h4 style="color:#bca06c;margin:.2em 0">ğŸ¥ˆ 2ìˆœìœ„: ${NAMES[top2]}</h4>
    <h4 style="color:#a78556;margin:.2em 0">ğŸ¥‰ 3ìˆœìœ„: ${NAMES[top3]}</h4>
    <p class="small" style="color:#2e1f13;background:rgba(255,255,255,.65);display:inline-block;padding:10px 12px;border-radius:10px">ê°•ì ì€ ìƒí™©ì— ë”°ë¼ ë” ìë„ ìˆ˜ ìˆì–´ìš”. ë‹¤ë¥¸ ìºë¦­í„°ë¡œë„ ëª¨í—˜ì„ í•´ë³´ë©° ìŠ¤í™íŠ¸ëŸ¼ì„ ë¹„êµí•´ ë³´ì„¸ìš”!</p>
  `;
  el('result-content').innerHTML = resultHTML;
}

// ì´ˆê¸°í™”
resetGame();
</script>
</body>
</html>
